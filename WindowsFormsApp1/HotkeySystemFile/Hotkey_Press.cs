using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Text;

namespace WindowsFormsApp1
{
    /// <summary>
    /// <para>
    ///     Hotkey System : Hotkey : Press
    /// </para>
    /// <para>
    ///     Written by : Lai Yu Ting
    /// </para>
    /// <para>
    ///     Latest update : 21/9/2020 14:29
    /// </para>
    /// </summary>
    public class Hotkey_Press : IKeyboardHookListener
    {

        //*************************************************************************************************
        //
        //  variable
        //
        //*************************************************************************************************

        protected KeyHook keyHook;
        protected IScript script;

        //*************************************************************************************************
        //*************************************************************************************************




        //*************************************************************************************************
        //
        //  program
        //
        //*************************************************************************************************

        //=================================================================================================
        //  constructor
        //=================================================================================================
        public Hotkey_Press(IScript script)
        {
            keyHook = new KeyHook(this); // new key hook
            this.script = script; // set callback 
            keyHook.Start(); // hook start
        }
        //=================================================================================================



        //=================================================================================================
        //  change hook key
        //=================================================================================================
        public void changeKey(int keyCode)
        {
            keyHook.setKey(keyCode);
        }
        //=================================================================================================



        //=================================================================================================
        //  hook block original input
        //=================================================================================================
        public void blockOriginalInput()
        {
            keyHook.blockOriginalInput = true;
        }
        //=================================================================================================



        //=================================================================================================
        //  hook unblock original input
        //=================================================================================================
        public void unblockOriginalInput()
        {
            keyHook.blockOriginalInput = false;
        }
        //=================================================================================================



        //=================================================================================================
        //  hook key down callback
        //=================================================================================================
        public virtual void keyDown()
        {
            script.scriptStart();
        }
        //=================================================================================================



        //=================================================================================================
        //  hook key up callback
        //=================================================================================================
        public virtual void keyUp()
        {
            script.scriptStop();
        }
        //=================================================================================================



        //=================================================================================================
        //  stop
        //=================================================================================================
        public void stop()
        {
            if(keyHook != null)
            {
                keyHook.Stop();
                keyHook = null;
            }
        }
        //=================================================================================================



        //=================================================================================================
        //  destructor
        //=================================================================================================
        ~Hotkey_Press()
        {
            stop();
        }
        //=================================================================================================

        //*************************************************************************************************
        //*************************************************************************************************


    }
}
